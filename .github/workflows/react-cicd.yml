name: React App - CI/CD Workflow

on:
  # Trigger when code committed to the main branch
  push:
    branches: [ main ]

  # Trigger manually
  workflow_dispatch:

jobs:

  # Build React app
  build:
    name: Build React app
    uses: msfred/templates/.github/workflows/build-react.yml@main
    with:
      project: MyReactApp
    secrets:
      token: ${{ secrets.token }}

  deploy:
    name: Deploy to ${{ matrix.environment }}
    runs-on: ubuntu-latest
    environment:
      name: ${{ matrix.environment }}
      url: https://${{ matrix.environment }}.product.company.com
    strategy:
      matrix:
        environment: ['development', 'production']
    steps:
      - name: Debug step for the Depoly to ${{ matrix.environment }} job
        run: echo "Starting the deploy to ${{ matrix.environment }}"
